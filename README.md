
# AdminBot   #11111111111111111111111111111111111111111111111111111111111111111111#

## Версия от 25.08.2024

## 1. Суть проекта
Проект AdminBot предназначен для автоматического администрирования организации мероприятий. Пользователи взаимодействуют с ботом Telegram, чтобы планировать мероприятия, выбирать язык, просматривать проформы и получать уведомления.

## 2. Файловая структура
Проект состоит из следующих файлов и директорий:
- `main.py`: Основной файл, запускающий бота и обрабатывающий взаимодействие с пользователями.
- `config/`
  - `config.py`: Файл конфигурации, содержащий путь к базе данных, токен бота и другие параметры.
- `helpers/`
  - `database_helpers.py`: Вспомогательные функции для работы с базой данных и отправки проформ пользователям.
- `modules/`
  - `constants.py`: Модуль, содержащий константы и классы для хранения данных пользователя.
- `keyboards.py`: Модуль, создающий различные клавиатуры для взаимодействия с пользователями.
- `translations.py`: Модуль, содержащий переводы текстов сообщений и кнопок на разных языках.

## 3. Архитектура

### 3.1 Принцип модульности
Принцип модульности используется для разделения функций бота на отдельные модули, каждый из которых выполняет свою задачу:
- **Основные модули** обрабатывают взаимодействие с пользователем, включая выбор языка, просмотр проформ и отправку сообщений.
- **Вспомогательные модули** управляют базой данных, логированием и конфигурацией.

### 3.2 Перечень модулей с их названиями

1. **Модуль 1** (Основной)
   - Название: `language_selection`
   - Описание: Выбор языка пользователем.
   - Функции: `language_selection_keyboard()`

2. **Модуль 2** (Основной)
   - Название: `greeting`
   - Описание: Приветствие пользователя и инициализация данных пользователя.
   - Функции: `start()`

3. **Модуль 3** (Основной)
   - Название: `proforma_handling`
   - Описание: Генерация и отправка проформ пользователям.
   - Функции: `get_full_proforma()`, `send_proforma_to_user()`

4. **Модуль 4** (Вспомогательный)
   - Название: `database_helpers`
   - Описание: Вспомогательные функции для работы с базой данных.
   - Функции: `get_user_data()`, `get_full_proforma()`, `send_proforma_to_user()`

5. **Модуль 5** (Основной)
   - Название: `keyboards`
   - Описание: Создание интерактивных клавиатур для взаимодействия с пользователем.
   - Функции: `language_selection_keyboard()`, `user_options_keyboard()`

6. **Модуль 6** (Вспомогательный)
   - Название: `constants`
   - Описание: Хранение констант и классов для данных пользователя.
   - Функции: `ORDER_STATUS`, `UserData`

7. **Модуль 7** (Вспомогательный)
   - Название: `translations`
   - Описание: Переводы текстов сообщений и кнопок на различные языки.
   - Функции: `translations`, `button_texts`

### 3.3 Принцип взаимодействия файлов

1. **main.py**: Основной файл, управляющий всеми взаимодействиями с пользователями и запуском бота.

   **Анализ файла main.py**:
   Этот файл является центральным элементом проекта и содержит настройки бота, обработчики команд, и логику взаимодействия с пользователями. Основные элементы:

   1. **Импорт библиотек**:
      - Импортируются необходимые библиотеки для работы с Telegram API, базой данных и вспомогательные функции.

   2. **Логирование**:
      - Логирование настраивается для записи в файл `admin_bot.log` с уровнем детализации DEBUG.

   3. **Асинхронные обработчики команд и сообщений**:
      - `start()`: Обрабатывает команду `/start`, инициализирует данные пользователя и предлагает выбрать язык.
      - `button_callback()`: Обрабатывает нажатия кнопок и управляет логикой бота, включая выбор языка и отправку проформ.

   4. **Запуск бота**:
      - Приложение инициализируется и запускается с добавлением соответствующих обработчиков команд и сообщений.

2. **database_helpers.py**: Вспомогательные функции для работы с базой данных.

   **Анализ файла database_helpers.py**:
   Этот файл содержит функции для получения данных пользователя, генерации и отправки проформ, а также обновления статуса заказов в базе данных.

   1. **Функции для работы с базой данных**:
      - `get_user_data()`: Получает данные пользователя по user_id.
      - `get_full_proforma()`: Получает полную информацию о заказе для генерации проформы.
      - `send_proforma_to_user()`: Отправляет проформу пользователю через Telegram.

3. **keyboards.py**: Модуль для создания различных клавиатур.

   **Анализ файла keyboards.py**:
   Этот файл содержит функции для генерации inline-клавиатур, таких как выбор языка и просмотр проформ.

   1. **Функции для генерации клавиатур**:
      - `language_selection_keyboard()`: Генерация клавиатуры для выбора языка.
      - `user_options_keyboard()`: Генерация клавиатуры для взаимодействия с проформой.

### 4. Новые компоненты в версии 1.0

#### 4.1 Добавлены следующие модули

1. **`database_helpers.py`**
   - Назначение: Управление взаимодействием с базой данных и отправкой сообщений пользователям.
   - Особенности: Включает функции для получения и отправки проформ, а также обновления статуса заказов.

2. **`translations.py`**
   - Назначение: Переводы текстов сообщений и кнопок на различные языки.
   - Особенности: Обеспечивает многоязычную поддержку для взаимодействия с пользователями.

### 5. Примечания

- В новой версии 1.0 реализованы базовые функции для управления мероприятиями, включая генерацию и отправку проформ.
- Улучшена структура логирования и обработки ошибок для упрощения отладки и мониторинга работы бота.
